
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Geochemical Transport &#8212; Amanzi-ATS</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/custom_theme.css?v=a03f4c85" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../_static/documentation_options.js?v=3ce10a4d"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'input_spec/process_kernels/physical/transport';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/amanzi/ats/master/docs/documentation/source/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'v1.5';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.js"></script>
    <script src="../../../_static/main.js?v=b10558fa"></script>
    <link rel="icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Energy PKs" href="energy.html" />
    <link rel="prev" title="Flow PKs" href="flow.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="dev" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo_full.png" class="logo__image only-light" alt="Amanzi-ATS documentation -- Home"/>
    <img src="../../../_static/logo_full.png" class="logo__image only-dark pst-js-only" alt="Amanzi-ATS documentation -- Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../demos.html">
    ATS Demo Problems
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    ATS Input Specification
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../demos.html">
    ATS Demo Problems
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    ATS Input Specification
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><!-- This will display the version of the docs -->
Version dev</div>
        <div class="sidebar-primary-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">About the Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../main.html">Main</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../mesh.html">Mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../region.html">Region</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../io/index.html">IO</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../io/ioevent.html">IOEvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../io/visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../io/observations.html">Observations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../io/checkpoint.html">Checkpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../io/logfile.html">Logfile Control</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Process Kernels</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../base.html">Base PKs</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="index.html">Physical PKs</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="flow.html">Flow PKs</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Geochemical Transport</a></li>
<li class="toctree-l3"><a class="reference internal" href="energy.html">Energy PKs</a></li>
<li class="toctree-l3"><a class="reference internal" href="seb.html">Surface Energy Balance PKs</a></li>
<li class="toctree-l3"><a class="reference internal" href="bgc.html">Biogeochemistry</a></li>
<li class="toctree-l3"><a class="reference internal" href="deformation.html">Deformation</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../mpcs/index.html">MPC</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../mpcs/base.html">Base MPCs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mpcs/tightly_coupled.html">Tightly Coupled MPCs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mpcs/multiple_domain.html">Multiple Domain MPCs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mpcs/globalization.html">Globalization Delegates</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../state/index.html">State</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../state/primary.html">Primary Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/independent.html">Independent Variables</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../state/secondary.html">Secondary Variables</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../state/conserved.html">Conserved quantities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../state/subsurface_flow.html">Subsurface Flow Evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../state/surface_flow.html">Surface Flow Evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../state/transport.html">Transport evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../state/thermo.html">Thermodynamic evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../state/eos.html">Equations of State</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../state/seb.html">Surface Energy Balance Evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../state/snow.html">Snow evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../state/canopy.html">Canopy evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../state/bgc.html">Carbon and Biogeochemistry Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../state/multiscale.html">Multiscale Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../state/geometric.html">Geometric evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../state/generic.html">Generic evaluators</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../math/index.html">Time integrators, solvers, and other mathematical specs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../math/time_integrators.html">Time Integrators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math/nonlinear_solvers.html">Nonlinear Solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math/linear_solvers.html">Linear Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math/preconditioners.html">Preconditioners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math/operators.html">Operators</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../common.html">Shared Specs</a></li>
</ul>
</div>
</nav></div>
        <div class="sidebar-primary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transport">Transport</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chemistry">Chemistry</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#salinity-transport">Salinity Transport</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sediment-transport">Sediment Transport</a></li>
</ul>
  </nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">ATS Input Specification</a></li>
    
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Process Kernels</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Physical PKs</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Geochemical Transport</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="geochemical-transport">
<h1>Geochemical Transport<a class="headerlink" href="#geochemical-transport" title="Link to this heading">#</a></h1>
<p>Geochemical transport capabilities are implemented in a few different PKs.</p>
<section id="transport">
<h2>Transport<a class="headerlink" href="#transport" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/amanzi/ats/blob/master/src/pks/transport/transport_ats.hh">src/physics/ats/src/pks/transport/transport_ats.hh</a></p>
<p>This PK solves for transport of chemical species in water.  It may optionally
be paired with a PK for reactions, typically in an operator-split form, to
solve reactive transport.</p>
<p>The advection-dispersion equation for component <em>i</em> may be written as:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial (\Theta \xi_i)}{\partial t} = - \boldsymbol{\nabla} \cdot (\boldsymbol{q} \xi_i)
+ \boldsymbol{\nabla} \cdot (\Theta \, (\boldsymbol{D^*}_l + \tau \boldsymbol{D}_i) \boldsymbol{\nabla} \xi_i) + Q_s,\]</div>
<p>The primary variable for this PK is <span class="math notranslate nohighlight">\(\xi_i\)</span>, the <strong>mole ratio</strong> of a
specie <span class="math notranslate nohighlight">\(i\)</span> in the aqueous phase, with units of [mol i / mol H2O].</p>
<p>This seems a bit odd to most people who are used to reactive transport codes
where the primary variable is total component concentration <span class="math notranslate nohighlight">\(C\)</span>, in units of [mol i
/ L].  The reason for this differences is to better enable variable-density
problems.  Note that the two are related:</p>
<div class="math notranslate nohighlight">
\[C_i = n_l \xi_i\]</div>
<p>for molar density of liquid water <span class="math notranslate nohighlight">\(n_l\)</span>.</p>
<p>For reactive transport problems, both concentration and mole ratio are output
in the visualization file.  For transport-only problems, concentration may be
output by adding a total component concentration evaluator that multiplies the
two quantities using an <cite>“evaluator type</cite>” = <cite>“multiplicative evaluator</cite>”.</p>
<p><cite>“PK type</cite>” = <cite>“transport ATS</cite>”</p>
<div class="admonition-pk-transport-ats-spec admonition" id="pk-transport-ats-spec">
<p class="admonition-title">pk-transport-ats-spec</p>
<ul class="simple">
<li><p><cite>“domain name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>“domain”</strong> specifies mesh name that defines
the domain of this PK.</p></li>
<li><p><cite>“component names</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> <strong>optional</strong> No default. Provides
the names of the components that will be transported.  Note that these
must be provided by the user if transport is used alone, or are provided
by the geochemical engine if reactions are to be used.</p></li>
<li><p><cite>“number of aqueous components</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>-1</strong> The total number of
aqueous components.  Default value is the length of <cite>“component names</cite>”</p></li>
<li><p><cite>“boundary conditions</cite>” <code class="docutils literal notranslate"><span class="pre">[transport-bc-spec]</span></code> Boundary conditions for
transport are dependent on the boundary conditions for flow. See
<a class="reference internal" href="../../common.html#transport-specific-boundary-conditions"><span class="std std-ref">Transport-specific Boundary Conditions</span></a></p></li>
<li><p><cite>“molecular diffusivity [m^2 s^-1]</cite>” <code class="docutils literal notranslate"><span class="pre">[molecular-diffusivity-spec]</span></code> See
below.</p></li>
<li><p><cite>“tortuosity [-]</cite>” <code class="docutils literal notranslate"><span class="pre">[tortuosity-spec]</span></code> See below.</p></li>
<li><p><cite>“source terms</cite>” <code class="docutils literal notranslate"><span class="pre">[transport-source-spec-list]</span></code> Provides solute source.</p></li>
</ul>
<p>Math and solver algorithm options:</p>
<ul class="simple">
<li><p><cite>“diffusion</cite>” <code class="docutils literal notranslate"><span class="pre">[pde-diffusion-typedinline-spec]</span></code> Diffusion drives the
distribution.  Typically we use finite volume here, but mimetic schemes
may be used.  See <a class="reference internal" href="../../math/operators.html#diffusion"><span class="std std-ref">Diffusion</span></a></p></li>
<li><p><cite>“diffusion preconditioner</cite>” <code class="docutils literal notranslate"><span class="pre">[pde-diffusion-typedinline-spec]</span></code> Inverse
of the above.  Likely only Jacobian term options are needed here, as the
others default to the same as the <cite>“diffusion</cite>” list.  See
<a class="reference internal" href="../../math/operators.html#diffusion"><span class="std std-ref">Diffusion</span></a>.</p></li>
<li><p><cite>“inverse</cite>” <code class="docutils literal notranslate"><span class="pre">[inverse-typed-spec]</span></code> <span class="xref std std-ref">Inverse</span> method for the
diffusion-dispersion solve.  See <span class="xref std std-ref">Inverse</span>.</p></li>
<li><p><cite>“cfl</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>1.0</strong> Courant-Friedrichs-Lewy condition, a limiter
on the timestep size relative to spatial size.  Must be &lt;= 1.</p></li>
<li><p><cite>“advection spatial discretization order</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>1</strong> Defines
accuracy of the spatial discretization in the advection term.  It permits
values 1 or 2. Default value is 1 (donor upwind) but 2 (a limiter scheme)
is much less numerically diffusive, and recommended for most cases.</p></li>
<li><p><cite>“temporal discretization order</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>1</strong> Defines accuracy of
temporal discretization.  It permits values 1 (forward Euler) and 2 (a
Runga-Kutta scheme).</p></li>
<li><p><cite>“reconstruction</cite>” <code class="docutils literal notranslate"><span class="pre">[reconstruction-spec]</span></code> collects reconstruction
parameters for use in reconstructing the velocity field for 2nd order
advection schemes.  See <span class="xref std std-ref">Reconstructions</span>.</p></li>
</ul>
<p>KEYS</p>
<ul>
<li><p><cite>“primary variable</cite>” <strong>“molar_ratio”</strong> [mol C mol H2O^-1]</p></li>
<li><p><cite>“liquid water content</cite>” <strong>“water_content”</strong> This variable is a multiplier
in in the accumulation term. This is often just <cite>“water_content</cite>”, but
not in frozen cases, where it must be defined by the user (typically as
<span class="math notranslate nohighlight">\(\phi s n_l |V|\)</span> in the subsurface, or <span class="math notranslate nohighlight">\(h n_l |V|\)</span> on the
surface.</p></li>
<li><p><cite>“molar density liquid</cite>” [mol H2O m^-3]</p></li>
<li><p><cite>“water flux</cite>” The face-based water flux in [mol H2O s^-1].</p></li>
<li><p><cite>“water source</cite>” Defines the water injection rate [mol H2O m^-2 s^-1] in
surface and [mol H2O m^-3 s^-1] in subsurface) which applies to
concentrations specified by the <cite>“geochemical conditions</cite>”.  Note that if
this PK is coupled to a surface flow PK, the unit of the water source
there <em>must</em> be in [mol m^-2 s^-1], <em>not</em> in [m s^-1] as is an option for
that PK (e.g. <cite>“water source in meters</cite>” must be set to <cite>“false</cite>” in the
overland flow PK).</p>
<p>The injection rate of a solute [molC s^-1], when given as the product of a
concentration and a water source, is evaluated as:</p>
<blockquote>
<div><p>Concentration [mol C L^-1] <span class="math notranslate nohighlight">\(\times\)</span>
1000 [L m^-3] of water <span class="math notranslate nohighlight">\(\times\)</span>
water source [mol H2O m^-3 s^-1] <span class="math notranslate nohighlight">\(\times\)</span>
volume of injection domain [m^3] <span class="math notranslate nohighlight">\(/\)</span>
molar density of water [mol H2O m^-3]</p>
</div></blockquote>
</li>
</ul>
</div>
<p>Note, this is not dispersion, but strictly isotropic diffusion.</p>
<div class="admonition-molecular-diffusivity-spec admonition" id="molecular-diffusivity-spec">
<p class="admonition-title">molecular-diffusivity-spec</p>
<p>For each aqueous component, a single value is provided for molecular diffusivity, e.g.</p>
<p><cite>“COMPONENT_NAME</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> value [m^2 s^-1]</p>
</div>
<div class="admonition-tortuosity-spec admonition" id="tortuosity-spec">
<p class="admonition-title">tortuosity-spec</p>
<ul class="simple">
<li><p><cite>“aqueous</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Defines tortuosity for calculating
diffusivity of liquid solutes, [-].</p></li>
<li><p><cite>“gaseous</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Defines tortuosity for calculating
diffusivity of gas solutes, [-].  Not currently implemented!</p></li>
</ul>
</div>
<div class="admonition-transport-source-spec admonition" id="transport-source-spec">
<p class="admonition-title">transport-source-spec</p>
<ul>
<li><p><cite>“component mass source</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code>  Defines solute source injection rate.</p>
<ul>
<li><p><cite>“spatial distribution method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> One of:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>“volume</cite>”, source is considered as extensive quantity [molC s^-1] and is evenly distributed across the region.</p></li>
<li><p><cite>“none</cite>”, source is considered as intensive quantity. [molC m^-2 s^-1] in surface and [molC m^-3 s^-1] in subsurface</p></li>
</ul>
</div></blockquote>
</li>
<li><p><cite>“geochemical</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code>  Defines a source by setting solute concentration for all components (in moles/L) and an injection
rate given by the water source.  Currently, this option is only available for Alquimia provided geochemical conditions.</p>
<ul class="simple">
<li><p><cite>“geochemical conditions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> List of geochemical constraints providing concentration for solute injection.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="chemistry">
<h2>Chemistry<a class="headerlink" href="#chemistry" title="Link to this heading">#</a></h2>
<p>Reactive transport is done by coupling a <a class="reference internal" href="#transport"><span class="std std-ref">Transport</span></a> PK with
chemistry using some variation on a <a class="reference internal" href="../mpcs/tightly_coupled.html#reactive-transport"><span class="std std-ref">Reactive Transport</span></a> MPC.
Currently, ATS only implements chemistry through <a class="reference external" href="https://doi.org/10.11578/dc.20210416.49">Alquimia</a>, which calls out to either
<a class="reference external" href="https://pflotran.org">PFloTran</a> or <a class="reference external" href="https://crunch.lbl.gov">Crunch</a> for reaction support.</p>
<p><a class="reference external" href="https://github.com/amanzi/amanzi/blob/master/src/pks/chemistry/Alquimia_PK.hh">src/pks/chemistry/Alquimia_PK.hh</a></p>
<p>The Alquimia PK leverages the Alquimia interface to implement chemical
reactions by calling out to a chemical engine.</p>
<p>This PK, when not coupled, solves the following set of ODEs:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial C_ij}{\partial t} = \sum_{k=1..nreactions} R_ik(C_{i=1..ncomponents,j})\]</div>
<p>for <span class="math notranslate nohighlight">\(k\)</span> indexing reactions, <span class="math notranslate nohighlight">\(i\)</span> indexing components, and <span class="math notranslate nohighlight">\(j\)</span>
indexing grid cells.  The total component concentrations <span class="math notranslate nohighlight">\(C\)</span> are in <cite>[kg L^-1]</cite>.</p>
<p>The details of how to parameterize and specify a reaction network are specific
to each geochemical engine, of which currently only PFloTran and Crunch are
supported.  Corresponding input files for these engines must be provided.
Examples are available in Amanzi’s user guide tests and ATS’s regression tests.</p>
<p><cite>“PK type</cite>” = <cite>“chemistry alquimia</cite>”</p>
<div class="admonition-pk-chemistry-alquimia-spec admonition">
<p class="admonition-title">pk-chemistry-alquimia-spec</p>
<ul class="simple">
<li><p><cite>“timestep controller</cite>” <code class="docutils literal notranslate"><span class="pre">[timestep-controller-typed-spec]</span></code> Timestep control parameters.</p></li>
<li><p><cite>“engine</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> One of:</p>
<ul>
<li><p><cite>“CrunchFlow</cite>”</p></li>
<li><p><cite>“PfloTran</cite>”</p></li>
</ul>
</li>
<li><p><cite>“engine input file</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> Path to the engine’s input file.</p></li>
</ul>
<p>KEYS:</p>
<ul class="simple">
<li><p><cite>“total component concentration</cite>”</p></li>
<li><p><cite>“mass density liquid</cite>”</p></li>
<li><p><cite>“porosity</cite>”</p></li>
<li><p><cite>“saturation liquid</cite>”</p></li>
<li><p><cite>“temperature</cite>”</p></li>
<li><p><cite>“mineral volume fractions</cite>”</p></li>
<li><p><cite>“mineral specific surface area</cite>”</p></li>
<li><p><cite>“mineral rate constant</cite>”</p></li>
<li><p><cite>“surface site density</cite>”</p></li>
<li><p><cite>“total_sorbed</cite>”</p></li>
<li><p><cite>“isotherm kd</cite>”</p></li>
<li><p><cite>“isotherm freundlich n</cite>”</p></li>
<li><p><cite>“isotherm langmuir b</cite>”</p></li>
<li><p><cite>“first order decay ratae constant</cite>”</p></li>
<li><p><cite>“cation exchange capacity</cite>”</p></li>
<li><p><cite>“aux data</cite>”</p></li>
<li><p><cite>“pH</cite>”</p></li>
</ul>
</div>
<p>See the Alquimia documentation for the needed input spec for a given engine.</p>
<blockquote>
<div><div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList&gt;</span><span class="w">  </span><span class="cm">&lt;!-- parent list --&gt;</span>
<span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;alquimia PK&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;engine&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;PFloTran&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;engine input file&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;tritium.in&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep controller&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep control type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;fixed&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;fixed parameters&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;timestep [s]&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;double&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;1.0e-02&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;/ParameterList&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="salinity-transport">
<h2>Salinity Transport<a class="headerlink" href="#salinity-transport" title="Link to this heading">#</a></h2>
<p>Salinity transport is not itself a PK, but may be implemented as a
variation on <a class="reference internal" href="#transport">Transport</a> by supplying equations of state that are a
function of the concentration of salt.  Examples of this are provided
in the regression tests and demos.</p>
</section>
<section id="sediment-transport">
<h2>Sediment Transport<a class="headerlink" href="#sediment-transport" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/amanzi/ats/blob/master/src/pks/transport/sediment_transport_pk.hh">src/physics/ats/src/pks/transport/sediment_transport_pk.hh</a></p>
<p>Document me &#64;dasvyat</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="flow.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Flow PKs</p>
      </div>
    </a>
    <a class="right-next"
       href="energy.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Energy PKs</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 202X, jointly shared by contributor institutions.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>