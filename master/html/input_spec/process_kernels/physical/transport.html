

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Transport PK &#8212; Amanzi-ATS</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/custom_theme.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'input_spec/process_kernels/physical/transport';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.3';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://amanzi.github.io/ats/v1.5/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'v1.5';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.js"></script>
    <script src="../../../_static/main.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Energy PKs" href="energy.html" />
    <link rel="prev" title="Flow PKs" href="flow.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo_full.png" class="logo__image only-light" alt="Amanzi-ATS - Home"/>
    <script>document.write(`<img src="../../../_static/logo_full.png" class="logo__image only-dark" alt="Amanzi-ATS - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../../../demos.html">
    ATS Demo Problems
  </a>
</li>


<li class="nav-item pst-header-nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    ATS Input Specification
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../../../demos.html">
    ATS Demo Problems
  </a>
</li>


<li class="nav-item pst-header-nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    ATS Input Specification
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">About the Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../main.html">Main</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../mesh.html">Mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../region.html">Region</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../io/index.html">IO</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../io/ioevent.html">IOEvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../io/visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../io/observations.html">Observations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../io/checkpoint.html">Checkpoint</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Process Kernels</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../base.html">Base PKs</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="index.html">Physical PKs</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="flow.html">Flow PKs</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Transport PK</a></li>
<li class="toctree-l3"><a class="reference internal" href="energy.html">Energy PKs</a></li>
<li class="toctree-l3"><a class="reference internal" href="seb.html">Surface Energy Balance PKs</a></li>


</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../mpcs/index.html">MPC</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../mpcs/base.html">Base MPCs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mpcs/physical.html">Physical MPCs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mpcs/globalization.html">Globalization Delegates</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../state/index.html">State</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../state/primary.html">Primary Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/independent.html">Independent Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/secondary.html">Secondary Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/conserved.html">Conserved quantities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/subsurface_flow.html">Subsurface flow evaluators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/surface_flow.html">Surface flow evaluators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/thermo.html">Thermodynamic evaluators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/eos.html">Equations of State</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/seb.html">Surface energy balance evaluators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/snow.html">Snow evaluators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/canopy.html">Canopy evaluators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/bgc.html">Carbon and Biogeochemistry Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/multiscale.html">Multiscale Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/geometric.html">Geometric evaluators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../state/generic.html">Generic evaluators</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../math/index.html">Time integrators, solvers, and other mathematical specs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../math/time_integrators.html">Time Integrators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math/nonlinear_solvers.html">Nonlinear Solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math/linear_solvers.html">Linear Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math/preconditioners.html">Preconditioners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../math/operators.html">Operators</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../common.html">Shared Specs</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">





<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">ATS Input Specification</a></li>
    
    
    <li class="breadcrumb-item"><i class="fa-solid fa-ellipsis"></i></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Physical PKs</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Transport PK</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="transport-pk">
<h1>Transport PK<a class="headerlink" href="#transport-pk" title="Permalink to this heading">#</a></h1>
<p>The Transport PK describes the conservation of mass of components transported
with water as it flows. The transport PK is based on the advection-diffusion
equation, applies to one or more components that are dissolved in the aqueous
phase, and is currently used in both surface and subsurface compartments.
The key difference between surface and subsurface transport is in capturing
the volume of water. In the subsurface, the volume of water is set by the
porosity and saturation of the porous medium, while in the surface it is set
by the ponded depth.</p>
<p>The advection-diffusion equation for component <em>i</em> in partially saturated porous media may be written as</p>
<div class="math notranslate nohighlight">
\[\frac{\partial (\phi s_l C_i)}{\partial t}
=
- \boldsymbol{\nabla} \cdot (\boldsymbol{q} C_i)
+ \boldsymbol{\nabla} \cdot (\phi s_l\, (\boldsymbol{D^*}_l + \tau \boldsymbol{D}_i) \boldsymbol{\nabla} C_i) + Q_s,\]</div>
<p>The advection-diffusion equation for component <em>i</em> in the surface may be written as</p>
<div class="math notranslate nohighlight">
\[\frac{\partial (C_i)}{\partial t}
=
- \boldsymbol{\nabla} \cdot (\boldsymbol{q_s} C_i)
+ \boldsymbol{\nabla} \cdot ( (\boldsymbol{D^*}_l + \tau \boldsymbol{D}_i) \boldsymbol{\nabla} C_i) + Q_s,\]</div>
<div class="admonition-transport-spec admonition" id="transport-spec">
<p class="admonition-title">transport-spec</p>
<ul class="simple">
<li><p><cite>“PK type</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>“transport ats”</strong></p></li>
<li><p><cite>“domain name</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>domain</strong> specifies mesh name that defines
the domain of this PK.</p></li>
<li><p><cite>“component names</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> No default. Provides the names of the
components that will be transported. Must be in the order: aqueous, gaseous, solid.</p></li>
<li><p><cite>“number of aqueous components</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>-1</strong> The total number of
aqueous components.  Default value is the length of <cite>“component names</cite>”</p></li>
<li><p><cite>“number of gaseous components</cite>” <code class="docutils literal notranslate"><span class="pre">[int]</span></code> <strong>0</strong> The total number of
gaseous components.</p></li>
<li><p><cite>“boundary conditions</cite>” <code class="docutils literal notranslate"><span class="pre">[transport-bc-spec]</span></code> Boundary conditions for
transport are dependent on the boundary conditions for flow. See
<a href="#id1"><span class="problematic" id="id2">`Flow-specific Boundary Conditions`_</span></a> and <a href="#id3"><span class="problematic" id="id4">`Transport-specific Boundary Conditions`_</span></a></p></li>
<li><p><cite>“component molar masses</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(double)]</span></code> No default. Molar mass of
each component.</p></li>
<li><p><cite>“molecular diffusion</cite>” <code class="docutils literal notranslate"><span class="pre">[molecular-diffusion-spec]</span></code> defines names of
solutes in aqueous and gaseous phases and related diffusivity values.</p></li>
<li><p>“material properties” <code class="docutils literal notranslate"><span class="pre">[material-properties-spec-list]</span></code> Defines material
properties see below).</p></li>
</ul>
<p>Source terms:</p>
<ul class="simple">
<li><p><cite>“source terms</cite>” <code class="docutils literal notranslate"><span class="pre">[transport-source-spec-list]</span></code> Provides solute source.</p></li>
</ul>
<p>Physical model and assumptions:</p>
<ul class="simple">
<li><p><cite>“physical models and assumptions</cite>” [material-properties-spec] Defines material properties.</p></li>
<li><p><cite>“effective transport porosity</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong> If <em>true</em>, effective transport porosity
will be used by dispersive-diffusive fluxes instead of total porosity.</p></li>
</ul>
<p>Math and solver algorithm options:</p>
<ul class="simple">
<li><p><cite>“diffusion</cite>” <code class="docutils literal notranslate"><span class="pre">[pde-diffusion-spec]</span></code> Diffusion drives the distribution.
Typically we use finite volume here.  See <a href="#id5"><span class="problematic" id="id6">PDE_Diffusion_</span></a></p></li>
<li><p><cite>“diffusion preconditioner</cite>” <code class="docutils literal notranslate"><span class="pre">[pde-diffusion-spec]</span></code> Inverse of the
above.  Likely only Jacobian term options are needed here, as the others
default to the same as the <cite>“diffusion</cite>” list.  See <a href="#id7"><span class="problematic" id="id8">PDE_Diffusion_</span></a>.</p></li>
<li><p><cite>“inverse</cite>” <code class="docutils literal notranslate"><span class="pre">[inverse-typed-spec]</span></code> <a href="#id9"><span class="problematic" id="id10">Inverse_</span></a> method for the solve.</p></li>
<li><p><cite>“cfl</cite>” [double] Time step limiter, a number less than 1. Default value is 1.</p></li>
<li><p><cite>“spatial discretization order</cite>” [int] defines accuracy of spatial discretization.
It permits values 1 or 2. Default value is 1.</p></li>
<li><p><cite>“temporal discretization order</cite>” [int] defines accuracy of temporal discretization.
It permits values 1 or 2 and values 3 or 4 when expert parameter
<cite>“generic RK implementation</cite>” is set to true. Note that RK3 is not monotone.
Default value is 1.</p></li>
<li><dl class="simple">
<dt><cite>“reconstruction</cite>” [list] collects reconstruction parameters. The available options are</dt><dd><p>describe in the separate section below.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>“transport subcycling</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>true</strong> The code will default to</dt><dd><p>subcycling for transport within the master PK if there is one.</p>
</dd>
</dl>
</li>
</ul>
<p>Developer parameters:</p>
<ul class="simple">
<li><dl class="simple">
<dt><cite>“enable internal tests</cite>” [bool] turns on various internal tests during</dt><dd><p>run time. Default value is <cite>“false</cite>”.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>“generic RK implementation</cite>” [bool] leads to generic implementation of</dt><dd><p>all Runge-Kutta methods. Default value is <cite>“false</cite>”.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>“internal tests tolerance</cite>” [double] tolerance for internal tests such as the</dt><dd><p>divergence-free condition. The default value is 1e-6.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>“runtime diagnostics: solute names</cite>” [Array(string)] defines solutes that will be</dt><dd><p>tracked closely each time step if verbosity <cite>“high</cite>”. Default value is the first
solute in the global list of <cite>“aqueous names</cite>” and the first gas in the global list
of <cite>“gaseous names</cite>”.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>“runtime diagnostics: regions</cite>” [Array(string)] defines a boundary region for</dt><dd><p>tracking solutes. Default value is a seepage face boundary, see Flow PK.</p>
</dd>
</dl>
</li>
</ul>
<p>KEYS</p>
<ul>
<li><dl class="simple">
<dt><cite>“saturation liquid</cite>” This variable is a multiplier in in the</dt><dd><p>accumulation term. For subsurface transport, this will typically be the
saturation (<cite>“saturation_liquid</cite>”). For surface transport, this will
typically be the ponded depth (<cite>“ponded_depth</cite>”).</p>
</dd>
</dl>
</li>
<li><p><cite>“previous saturation liquid</cite>”</p></li>
<li><dl class="simple">
<dt><cite>“molar density liquid</cite>”  Transport is solved</dt><dd><p>for concentrations in units of mol fractions. Molar density is needed for conversion.</p>
</dd>
</dl>
</li>
<li><p><cite>“water flux</cite>”</p></li>
<li><dl>
<dt><cite>“water source</cite>” Defines the water injection rate [mol H2O m^-2 s^-1] in</dt><dd><p>surface and [mol H2O m^-3 s^-1] in subsurface) which applies to
concentrations specified by the <cite>“geochemical conditions</cite>”.  Note that if
this PK is coupled to a surface flow PK, the unit of the water source
there <em>must</em> be in [mol m^-2 s^-1], <em>not</em> in [m s^-1] as is an option for
that PK (e.g. <cite>“water source in meters</cite>” must be set to <cite>“false</cite>” in the
overland flow PK).</p>
<p>The injection rate of a solute [molC s^-1], when given as the product of
a concentration and a water source, is evaluated as:</p>
<dl class="simple">
<dt>Concentration [mol C L^-1] *</dt><dd><p>1000 [L m^-3] of water *
water source [mol H2O m^-3 s^-1] *
volume of injection domain [m^3] /
molar density of water [mol H2O m^-3]</p>
</dd>
</dl>
</dd>
</dl>
</li>
</ul>
</div>
<div class="admonition-molecular-diffusion-spec admonition" id="molecular-diffusion-spec">
<p class="admonition-title">molecular-diffusion-spec</p>
<ul class="simple">
<li><p><cite>“aqueous names</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> List of aqueous component names to
be diffused.</p></li>
<li><p><cite>“aqueous values</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> Diffusivities of each component.</p></li>
</ul>
</div>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;molecular diffusion&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;aqueous names&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{CO2(l),Tc-99}&quot;</span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;aqueous values&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">Array(double)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{1e-8,1e-9}&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<div class="admonition-material-properties-spec admonition" id="material-properties-spec">
<p class="admonition-title">material-properties-spec</p>
<ul class="simple">
<li><p><cite>“region</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> Defines geometric regions for material SOIL.</p></li>
<li><p><cite>“model</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> <strong>scalar</strong> Defines dispersivity model.  One of:</p>
<ul>
<li><p><cite>“scalar</cite>” : scalar dispersivity</p></li>
<li><p><cite>“Bear</cite>” : dispersion split into along- and across- velocity</p></li>
<li><p><cite>“Burnett-Frind</cite>”</p></li>
<li><p><cite>“Lichtner-Kelkar-Robinson</cite>”</p></li>
</ul>
</li>
<li><p><cite>“parameters for MODEL</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code> where <cite>“MODEL</cite>” is the model name.</p></li>
</ul>
<p>IF model == scalar</p>
<p>ONE OF</p>
<ul class="simple">
<li><p><cite>“alpha</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines dispersivity in all directions, [m].</p></li>
</ul>
<p>OR</p>
<ul class="simple">
<li><p><cite>“dispersion coefficient</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines dispersion coefficient [m^2 s^-1].</p></li>
</ul>
<p>END</p>
<p>ELSE IF model == Bear</p>
<ul class="simple">
<li><p><cite>“alpha_l</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines dispersion in the direction of Darcy velocity, [m].</p></li>
<li><p><cite>“alpha_t</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines dispersion in the orthogonal direction, [m].</p></li>
</ul>
<p>ELSE IF model == Burnett-Frind</p>
<ul class="simple">
<li><p><cite>“alphaL</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines the longitudinal dispersion in the direction
of Darcy velocity, [m].</p></li>
<li><p><cite>“alpha_th</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Defines the transverse dispersion in the horizonal
direction orthogonal directions, [m].</p></li>
<li><p><cite>“alpha_tv</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Defines dispersion in the orthogonal directions,
[m].  When <cite>“alpha_th</cite>” equals to <cite>“alpha_tv</cite>”, we obtain dispersion in
the direction of the Darcy velocity.</p></li>
</ul>
<p>ELSE IF model == Lichtner-Kelker-Robinson</p>
<ul class="simple">
<li><p><cite>“alpha_lh</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> defines the longitudinal dispersion in the
horizontal direction, [m].</p></li>
<li><p><cite>“alpha_lv</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Defines the longitudinal dispersion in the vertical
direction, [m].  When <cite>“alpha_lh</cite>” equals to <cite>“alpha_lv</cite>”, we obtain
dispersion in the direction of the Darcy velocity.</p></li>
<li><p><cite>“alpha_th</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Defines the transverse dispersion in the horizontal
direction orthogonal directions, [m].</p></li>
<li><p><cite>“alpha_tv” ``[double]`</cite> Defines dispersion in the orthogonal directions.
When <cite>“alpha_th</cite>” equals to <cite>“alpha_tv</cite>”, we obtain dispersion in the
direction of the Darcy velocity.</p></li>
</ul>
<p>END</p>
<ul class="simple">
<li><p><cite>“aqueous tortuosity</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Defines tortuosity for calculating
diffusivity of liquid solutes, [-].</p></li>
<li><p><cite>“gaseous tortuosity</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> Defines tortuosity for calculating
diffusivity of gas solutes, [-].</p></li>
</ul>
</div>
<div class="admonition-transport-source-spec admonition" id="transport-source-spec">
<p class="admonition-title">transport-source-spec</p>
<ul>
<li><p><cite>“component mass source</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code>  Defines solute source injection rate.</p>
<ul>
<li><p><cite>“spatial distribution method</cite>” <code class="docutils literal notranslate"><span class="pre">[string]</span></code> One of:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>“volume</cite>”, source is considered as extensive quantity [molC s^-1] and is evenly distributed across the region.</p></li>
<li><p><cite>“none</cite>”, source is considered as intensive quantity. [molC m^-2 s^-1] in surface and [molC m^-3 s^-1] in subsurface</p></li>
</ul>
</div></blockquote>
</li>
<li><p><cite>“geochemical</cite>” <code class="docutils literal notranslate"><span class="pre">[list]</span></code>  Defines a source by setting solute concentration for all components (in moles/L) and an injection
rate given by the water source.  Currently, this option is only available for Alquimia provided geochemical conditions.</p>
<ul class="simple">
<li><p><cite>“geochemical conditions</cite>” <code class="docutils literal notranslate"><span class="pre">[Array(string)]</span></code> List of geochemical constraints providing concentration for solute injection.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="flow.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Flow PKs</p>
      </div>
    </a>
    <a class="right-next"
       href="energy.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Energy PKs</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 202X, jointly shared by contributor institutions.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.1.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>