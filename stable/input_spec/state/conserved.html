
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Conserved quantities &#8212; Amanzi-ATS</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/custom_theme.css?v=a03f4c85" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=3ce10a4d"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'input_spec/state/conserved';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/amanzi/ats/master/docs/documentation/source/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'v1.6';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.js"></script>
    <script src="../../_static/main.js?v=b10558fa"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Subsurface Flow Evaluators" href="subsurface_flow.html" />
    <link rel="prev" title="Secondary Variables" href="secondary.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="dev" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo_full.png" class="logo__image only-light" alt="Amanzi-ATS documentation -- Home"/>
    <img src="../../_static/logo_full.png" class="logo__image only-dark pst-js-only" alt="Amanzi-ATS documentation -- Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../demos.html">
    ATS Demo Problems
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    ATS Input Specification
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../demos.html">
    ATS Demo Problems
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    ATS Input Specification
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><!-- This will display the version of the docs -->
Version dev</div>
        <div class="sidebar-primary-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">About the Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main.html">Main</a></li>

<li class="toctree-l1"><a class="reference internal" href="../mesh.html">Mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../region.html">Region</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../io/index.html">IO</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../io/ioevent.html">IOEvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../io/visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../io/observations.html">Observations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../io/checkpoint.html">Checkpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../io/logfile.html">Logfile Control</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../process_kernels/index.html">Process Kernels</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../process_kernels/base.html">Base PKs</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../process_kernels/physical/index.html">Physical PKs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../process_kernels/physical/flow.html">Flow PKs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process_kernels/physical/transport.html">Geochemical Transport</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process_kernels/physical/energy.html">Energy PKs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process_kernels/physical/seb.html">Surface Energy Balance PKs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process_kernels/physical/bgc.html">Biogeochemistry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process_kernels/physical/deformation.html">Deformation</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../process_kernels/mpcs/index.html">MPC</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../process_kernels/mpcs/base.html">Base MPCs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process_kernels/mpcs/tightly_coupled.html">Tightly Coupled MPCs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process_kernels/mpcs/multiple_domain.html">Multiple Domain MPCs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../process_kernels/mpcs/globalization.html">Globalization Delegates</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">State</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="primary.html">Primary Variables</a></li>

<li class="toctree-l2"><a class="reference internal" href="independent.html">Independent Variables</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="secondary.html">Secondary Variables</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Conserved quantities</a></li>
<li class="toctree-l3"><a class="reference internal" href="subsurface_flow.html">Subsurface Flow Evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="surface_flow.html">Surface Flow Evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="transport.html">Transport evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermo.html">Thermodynamic evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="eos.html">Equations of State</a></li>
<li class="toctree-l3"><a class="reference internal" href="seb.html">Surface Energy Balance Evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="snow.html">Snow evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="canopy.html">Canopy evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="bgc.html">Carbon and Biogeochemistry Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="multiscale.html">Multiscale Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="geometric.html">Geometric evaluators</a></li>
<li class="toctree-l3"><a class="reference internal" href="generic.html">Generic evaluators</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../math/index.html">Time integrators, solvers, and other mathematical specs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../math/time_integrators.html">Time Integrators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/nonlinear_solvers.html">Nonlinear Solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/linear_solvers.html">Linear Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/preconditioners.html">Preconditioners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/operators.html">Operators</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../common.html">Shared Specs</a></li>
</ul>
</div>
</nav></div>
        <div class="sidebar-primary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#richards-equation-water-content-liquid-only">Richards Equation water content (liquid only)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#liquid-gas-water-content">Liquid+Gas water content</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#liquid-ice-water-content">Liquid+Ice water content</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#liquid-ice-gas-water-content">Liquid+Ice+Gas water content</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#surface-water-content">Surface water content</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#snow-or-canopy-water-content">Snow or canopy water content</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#richards-energy">Richards energy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#liquid-gas-energy">Liquid+Gas energy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#liquid-ice-energy">Liquid+Ice energy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#liquid-ice-gas-energy">Liquid+Ice+Gas energy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#surface-water-ice-energy">Surface water+ice energy</a></li>
</ul>
  </nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">ATS Input Specification</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">State</a></li>
    
    
    <li class="breadcrumb-item"><a href="secondary.html" class="nav-link">Secondary Variables</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Conserved quantities</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="conserved-quantities">
<h1>Conserved quantities<a class="headerlink" href="#conserved-quantities" title="Link to this heading">#</a></h1>
<p>Nearly all ATS process kernels are conservation equations, where there
is a formal conserved quantity, that, upon convergence, is conserved
to tolerance.  These are always an “extensive” quantity.</p>
<p>Water content in ATS is always measured on <code class="docutils literal notranslate"><span class="pre">[mol]</span></code> and therefore
includes a factor of the cell volume.  Energy in ATS is always
measured in <code class="docutils literal notranslate"><span class="pre">[MJ]</span></code>.  Unlike nearly all other variables, this is not
SI, and is done so because this makes for fairly evenly balanced
equations between a coupled flow and energy problem.</p>
<section id="richards-equation-water-content-liquid-only">
<h2>Richards Equation water content (liquid only)<a class="headerlink" href="#richards-equation-water-content-liquid-only" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/amanzi/ats/blob/master/src/pks/flow/constitutive_relations/water_content/richards_water_content_evaluator.hh">src/physics/ats/src/pks/flow/constitutive_relations/water_content/richards_water_content_evaluator.hh</a></p>
<p>Richards water content evaluator: the standard form as a function of liquid saturation.</p>
<div class="math notranslate nohighlight">
\[\Theta = n s \phi V\]</div>
<p><cite>“evaluator type</cite>” = <cite>“richards water content</cite>”</p>
<div class="admonition-evaluator-richards-water-content-spec admonition" id="evaluator-richards-water-content-spec">
<p class="admonition-title">evaluator-richards-water-content-spec</p>
<p>DEPENDENCIES:</p>
<ul class="simple">
<li><p><cite>“porosity</cite>”</p></li>
<li><p><cite>“molar density liquid</cite>”</p></li>
<li><p><cite>“saturation liquid</cite>”</p></li>
<li><p><cite>“cell volume</cite>”</p></li>
</ul>
</div>
</section>
<section id="liquid-gas-water-content">
<h2>Liquid+Gas water content<a class="headerlink" href="#liquid-gas-water-content" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/amanzi/ats/blob/master/src/pks/flow/constitutive_relations/water_content/liquid_gas_water_content_evaluator.hh">src/physics/ats/src/pks/flow/constitutive_relations/water_content/liquid_gas_water_content_evaluator.hh</a></p>
<p>Water content for liquid + water vapor.</p>
<div class="math notranslate nohighlight">
\[\Theta = (n_l s_l + n_g s_g \omega) \phi V\]</div>
<p><cite>“evaluator type</cite>” = <cite>“liquid+gas water content</cite>”</p>
<div class="admonition-evaluator-liquid-gas-water-content-spec admonition" id="evaluator-liquid-gas-water-content-spec">
<p class="admonition-title">evaluator-liquid-gas-water-content-spec</p>
<p>DEPENDENCIES:</p>
<ul class="simple">
<li><p><cite>“porosity</cite>”</p></li>
<li><p><cite>“molar density liquid</cite>”</p></li>
<li><p><cite>“molar density gas</cite>”</p></li>
<li><p><cite>“saturation liquid</cite>”</p></li>
<li><p><cite>“saturation gas</cite>”</p></li>
<li><p><cite>“mol frac gas</cite>”</p></li>
<li><p><cite>“cell volume</cite>”</p></li>
</ul>
</div>
</section>
<section id="liquid-ice-water-content">
<h2>Liquid+Ice water content<a class="headerlink" href="#liquid-ice-water-content" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/amanzi/ats/blob/master/src/pks/flow/constitutive_relations/water_content/liquid_ice_water_content_evaluator.hh">src/physics/ats/src/pks/flow/constitutive_relations/water_content/liquid_ice_water_content_evaluator.hh</a></p>
<p>Water content for liquid + water vapor.</p>
<div class="math notranslate nohighlight">
\[\Theta = (n_l s_l + n_i s_i) \phi V\]</div>
<p><cite>“evaluator type</cite>” = <cite>“liquid+ice water content</cite>”</p>
<div class="admonition-evaluator-liquid-ice-water-content-spec admonition" id="evaluator-liquid-ice-water-content-spec">
<p class="admonition-title">evaluator-liquid-ice-water-content-spec</p>
<p>DEPENDENCIES:</p>
<ul class="simple">
<li><p><cite>“porosity</cite>”</p></li>
<li><p><cite>“molar density liquid</cite>”</p></li>
<li><p><cite>“molar density ice</cite>”</p></li>
<li><p><cite>“saturation liquid</cite>”</p></li>
<li><p><cite>“saturation ice</cite>”</p></li>
<li><p><cite>“cell volume</cite>”</p></li>
</ul>
</div>
</section>
<section id="liquid-ice-gas-water-content">
<h2>Liquid+Ice+Gas water content<a class="headerlink" href="#liquid-ice-gas-water-content" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/amanzi/ats/blob/master/src/pks/flow/constitutive_relations/water_content/three_phase_water_content_evaluator.hh">src/physics/ats/src/pks/flow/constitutive_relations/water_content/three_phase_water_content_evaluator.hh</a></p>
<p>Three phase water content: vapor, liquid, and ice.</p>
<div class="math notranslate nohighlight">
\[\Theta = (n_l s_l + n_i s_i + n_g s_g \omega_g ) \phi V\]</div>
<p><cite>“evaluator type</cite>” = <cite>“three phase water content</cite>”</p>
<div class="admonition-evaluator-three-phase-water-content-spec admonition" id="evaluator-three-phase-water-content-spec">
<p class="admonition-title">evaluator-three-phase-water-content-spec</p>
<p>DEPENDENCIES:</p>
<ul class="simple">
<li><p><cite>“porosity</cite>”</p></li>
<li><p><cite>“molar density liquid</cite>”</p></li>
<li><p><cite>“saturation liquid</cite>”</p></li>
<li><p><cite>“molar density ice</cite>”</p></li>
<li><p><cite>“saturation ice</cite>”</p></li>
<li><p><cite>“molar density gas</cite>”</p></li>
<li><p><cite>“saturation gas</cite>”</p></li>
<li><p><cite>“molar fraction gas</cite>”</p></li>
<li><p><cite>“cell volume</cite>”</p></li>
</ul>
</div>
</section>
<section id="surface-water-content">
<h2>Surface water content<a class="headerlink" href="#surface-water-content" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/amanzi/ats/blob/master/src/pks/flow/constitutive_relations/water_content/overland_pressure_water_content_evaluator.hh">src/physics/ats/src/pks/flow/constitutive_relations/water_content/overland_pressure_water_content_evaluator.hh</a></p>
<p>Computes water content for a water-only surface water problem.  This can be
used to both compute an extensive water content (which is always non-negative)
or a “bar” water content which can be negative for pressures less than
atmospheric pressure for use in preconditioners.</p>
<p>By default:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Theta_s = \begin{cases}
             0 &amp; \text{if} \, p &lt; p_{atm} \\
             V \frac{1}{M_{H2O} g_z} \frac{(p - p_{atm})^2}{2 R} &amp; \text{if} \, p_{atm} &lt;= p &lt; R \\
             V \frac{1}{M_{H2O} g_z} (p - p_{atm} - \frac{R}{2}) &amp; \text{if} \, \text{R &lt;= p}
           \end{cases}\end{split}\]</div>
<p>for molar mass <span class="math notranslate nohighlight">\(M_{H2O}\)</span>, rollover cutoff <span class="math notranslate nohighlight">\(R\)</span>, and gravity <span class="math notranslate nohighlight">\(g\)</span>.</p>
<p>If <cite>“allow negative water content</cite>” is true, then the first conditional is
ignored (in this case <span class="math notranslate nohighlight">\(R = 0\)</span> and is ignored).</p>
<p>Note this is not valid for concentration-dependent density problems.</p>
<p><cite>“evaluator type</cite>” = <cite>“overland pressure water content</cite>”</p>
<div class="admonition-evaluator-overland-pressure-water-content-spec admonition" id="evaluator-overland-pressure-water-content-spec">
<p class="admonition-title">evaluator-overland-pressure-water-content-spec</p>
<ul class="simple">
<li><p><cite>“allow negative water content</cite>” <code class="docutils literal notranslate"><span class="pre">[bool]</span></code> <strong>false</strong>  See above</p></li>
<li><p><cite>“water content rollover [Pa]</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>0</strong> A smoothing term that
also can represent subgrid topography.  Not typically used.</p></li>
<li><p><cite>“molar mass [kg mol^-1]</cite>” <code class="docutils literal notranslate"><span class="pre">[double]</span></code> <strong>0.0180153</strong></p></li>
</ul>
<p>DEPENDENCIES:</p>
<ul class="simple">
<li><p><cite>“pressure</cite>”</p></li>
<li><p><cite>“cell volume</cite>”</p></li>
<li><p><cite>“atmospheric_pressure</cite>”</p></li>
<li><p><cite>“gravity</cite>”</p></li>
</ul>
</div>
</section>
<section id="snow-or-canopy-water-content">
<h2>Snow or canopy water content<a class="headerlink" href="#snow-or-canopy-water-content" title="Link to this heading">#</a></h2>
<p>Most other water contents can be formed as <a class="reference internal" href="generic.html#multiplicative"><span class="std std-ref">Multiplicative</span></a>
evaluators.  See below for a few examples:</p>
<p>Multiplicative evalutator for <cite>snow-water_content</cite>:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;snow-water_content&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;field evaluator type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;multiplicative evaluator&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;evaluator dependencies&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{snow-cell_volume, snow-water_equivalent, surface-molar_density_liquid}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;units&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mol&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
<p>Multiplicative evaluator for <cite>canopy-water_content</cite>:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ParameterList</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;canopy-water_content&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;ParameterList&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;field evaluator type&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;multiplicative evaluator&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;evaluator dependencies&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;Array(string)&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;{canopy-cell_volume, canopy-water_equivalent, surface-molar_density_liquid}&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">  </span><span class="nt">&lt;Parameter</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;units&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;string&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;mol&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ParameterList&gt;</span>
</pre></div>
</div>
</section>
<section id="richards-energy">
<h2>Richards energy<a class="headerlink" href="#richards-energy" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/amanzi/ats/blob/master/src/pks/energy/constitutive_relations/energy/richards_energy_evaluator.hh">src/physics/ats/src/pks/energy/constitutive_relations/energy/richards_energy_evaluator.hh</a></p>
<p>Energy content evaluator for a standard Richards equation’s water content.</p>
<p>Energy associated with a soil and pore-water system, in [KJ]</p>
<div class="math notranslate nohighlight">
\[E = V * ( \phi u_l s_l n_l + (1-\phi_0) u_r \rho_r )\]</div>
<p><cite>“evaluator type</cite>” = <cite>“richards energy</cite>”</p>
<p>Note this equation assumes that porosity is compressible, but is based on the
uncompressed rock grain density (not bulk density).  This means that porosity
is the base, uncompressible value when used with the energy in the grain, but
the larger, compressible value when used with the energy in the water.</p>
<p>Note that this ignores energy in the gas phase.</p>
<div class="admonition-evaluator-richards-energy-spec admonition" id="evaluator-richards-energy-spec">
<p class="admonition-title">evaluator-richards-energy-spec</p>
<p>DEPENDENCIES:</p>
<ul class="simple">
<li><p><cite>“porosity</cite>” The porosity, including any compressibility. [-]</p></li>
<li><p><cite>“base porosity</cite>” The uncompressed porosity (note this may be the same as
porosity for incompressible cases) [-]</p></li>
<li><p><cite>“molar density liquid</cite>” [mol m^-3]</p></li>
<li><p><cite>“saturation liquid</cite>” [-]</p></li>
<li><p><cite>“internal energy liquid</cite>” [KJ mol^-1]</p></li>
<li><p><cite>“density rock</cite>” Units may be either [kg m^-3] or [mol m^-3]</p></li>
<li><p><cite>“internal energy rock</cite>” Units may be either [KJ kg^-1] or [KJ mol^-1],
but must be consistent with the above density.</p></li>
<li><p><cite>“cell volume</cite>” [m^3]</p></li>
</ul>
</div>
</section>
<section id="liquid-gas-energy">
<h2>Liquid+Gas energy<a class="headerlink" href="#liquid-gas-energy" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/amanzi/ats/blob/master/src/pks/energy/constitutive_relations/energy/liquid_gas_energy_evaluator.hh">src/physics/ats/src/pks/energy/constitutive_relations/energy/liquid_gas_energy_evaluator.hh</a></p>
<p>Energy content evaluator for a standard Richards equation, including energy in the gas phase.</p>
<p>Calculates energy, in [KJ], via the equation:</p>
<div class="math notranslate nohighlight">
\[E = V * ( \phi (u_l s_l n_l + u_g s_g n_g)  + (1-\phi_0) u_r \rho_r )\]</div>
<p><cite>“evaluator type</cite>” = <cite>“liquid+gas energy</cite>”</p>
<p>Note this equation assumes that porosity is compressible, but is based on the
uncompressed rock grain density (not bulk density).  This means that porosity
is the base, uncompressible value when used with the energy in the grain, but
the larger, compressible value when used with the energy in the water.</p>
<div class="admonition-evaluator-liquid-gas-energy-spec admonition" id="evaluator-liquid-gas-energy-spec">
<p class="admonition-title">evaluator-liquid-gas-energy-spec</p>
<p>DEPENDENCIES:</p>
<ul class="simple">
<li><p><cite>“porosity</cite>” The porosity, including any compressibility. [-]</p></li>
<li><p><cite>“base porosity</cite>” The uncompressed porosity (note this may be the same as
porosity for incompressible cases) [-]</p></li>
<li><p><cite>“molar density liquid</cite>” [mol m^-3]</p></li>
<li><p><cite>“saturation liquid</cite>” [-]</p></li>
<li><p><cite>“internal energy liquid</cite>” [KJ mol^-1]</p></li>
<li><p><cite>“molar density gas</cite>” [mol m^-3]</p></li>
<li><p><cite>“saturation gas</cite>” [-]</p></li>
<li><p><cite>“internal energy gas</cite>” [KJ mol^-1]</p></li>
<li><p><cite>“density rock</cite>” Units may be either [kg m^-3] or [mol m^-3]</p></li>
<li><p><cite>“internal energy rock</cite>” Units may be either [KJ kg^-1] or [KJ mol^-1],
but must be consistent with the above density.</p></li>
<li><p><cite>“cell volume</cite>” [m^3]</p></li>
</ul>
</div>
</section>
<section id="liquid-ice-energy">
<h2>Liquid+Ice energy<a class="headerlink" href="#liquid-ice-energy" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/amanzi/ats/blob/master/src/pks/energy/constitutive_relations/energy/liquid_ice_energy_evaluator.hh">src/physics/ats/src/pks/energy/constitutive_relations/energy/liquid_ice_energy_evaluator.hh</a></p>
<p>Energy content evaluator for a two-phase system, including energy in an ice phase.</p>
<p>Calculates energy, in [KJ], via the equation:</p>
<div class="math notranslate nohighlight">
\[E = V * ( \phi (u_l s_l n_l + u_i s_i n_i)  + (1-\phi_0) u_r \rho_r )\]</div>
<p><cite>“evaluator type</cite>” = <cite>“liquid+ice energy</cite>”</p>
<p>Note this equation assumes that porosity is compressible, but is based on the
uncompressed rock grain density (not bulk density).  This means that porosity
is the base, uncompressible value when used with the energy in the grain, but
the larger, compressible value when used with the energy in the water.</p>
<p>Note that this ignores energy in the gas phase.</p>
<div class="admonition-evaluator-liquid-ice-energy-spec admonition" id="evaluator-liquid-ice-energy-spec">
<p class="admonition-title">evaluator-liquid-ice-energy-spec</p>
<p>DEPENDENCIES:</p>
<ul class="simple">
<li><p><cite>“porosity</cite>” The porosity, including any compressibility. [-]</p></li>
<li><p><cite>“base porosity</cite>” The uncompressed porosity (note this may be the same as
porosity for incompressible cases) [-]</p></li>
<li><p><cite>“molar density liquid</cite>” [mol m^-3]</p></li>
<li><p><cite>“saturation liquid</cite>” [-]</p></li>
<li><p><cite>“internal energy liquid</cite>” [KJ mol^-1]</p></li>
<li><p><cite>“molar density ice</cite>” [mol m^-3]</p></li>
<li><p><cite>“saturation ice</cite>” [-]</p></li>
<li><p><cite>“internal energy ice</cite>” [KJ mol^-1]</p></li>
<li><p><cite>“density rock</cite>” Units may be either [kg m^-3] or [mol m^-3]</p></li>
<li><p><cite>“internal energy rock</cite>” Units may be either [KJ kg^-1] or [KJ mol^-1],
but must be consistent with the above density.</p></li>
<li><p><cite>“cell volume</cite>” [m^3]</p></li>
</ul>
</div>
</section>
<section id="liquid-ice-gas-energy">
<h2>Liquid+Ice+Gas energy<a class="headerlink" href="#liquid-ice-gas-energy" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/amanzi/ats/blob/master/src/pks/energy/constitutive_relations/energy/three_phase_energy_evaluator.hh">src/physics/ats/src/pks/energy/constitutive_relations/energy/three_phase_energy_evaluator.hh</a></p>
<p>Energy content evaluator for a three-phase, gas, liquid, ice system including the surrounding soil.</p>
<p>Calculates energy, in [KJ], via the equation:</p>
<div class="math notranslate nohighlight">
\[E = V * ( \phi (u_l s_l n_l + u_i s_i n_i + u_g s_g n_g)  + (1-\phi_0) u_r \rho_r )\]</div>
<p><cite>“evaluator type</cite>” = <cite>“three phase energy</cite>”</p>
<p>Note this equation assumes that porosity is compressible, but is based on the
uncompressed rock grain density (not bulk density).  This means that porosity
is the base, uncompressible value when used with the energy in the grain, but
the larger, compressible value when used with the energy in the water.</p>
<div class="admonition-evaluator-three-phase-energy-spec admonition" id="evaluator-three-phase-energy-spec">
<p class="admonition-title">evaluator-three-phase-energy-spec</p>
<p>DEPENDENCIES:</p>
<ul class="simple">
<li><p><cite>“porosity</cite>” The porosity, including any compressibility. [-]</p></li>
<li><p><cite>“base porosity</cite>” The uncompressed porosity (note this may be the same as
porosity for incompressible cases) [-]</p></li>
<li><p><cite>“molar density liquid</cite>” [mol m^-3]</p></li>
<li><p><cite>“saturation liquid</cite>” [-]</p></li>
<li><p><cite>“internal energy liquid</cite>” [KJ mol^-1]</p></li>
<li><p><cite>“molar density ice</cite>” [mol m^-3]</p></li>
<li><p><cite>“saturation ice</cite>” [-]</p></li>
<li><p><cite>“internal energy ice</cite>” [KJ mol^-1]</p></li>
<li><p><cite>“molar density gas</cite>” [mol m^-3]</p></li>
<li><p><cite>“saturation gas</cite>” [-]</p></li>
<li><p><cite>“internal energy gas</cite>” [KJ mol^-1]</p></li>
<li><p><cite>“density rock</cite>” Units may be either [kg m^-3] or [mol m^-3]</p></li>
<li><p><cite>“internal energy rock</cite>” Units may be either [KJ kg^-1] or [KJ mol^-1],
but must be consistent with the above density.</p></li>
<li><p><cite>“cell volume</cite>” [m^3]</p></li>
</ul>
</div>
</section>
<section id="surface-water-ice-energy">
<h2>Surface water+ice energy<a class="headerlink" href="#surface-water-ice-energy" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://github.com/amanzi/ats/blob/master/src/pks/energy/constitutive_relations/energy/surface_ice_energy_evaluator.hh">src/physics/ats/src/pks/energy/constitutive_relations/energy/surface_ice_energy_evaluator.hh</a></p>
<p>Energy content for a surface water, partially frozen system.</p>
<p>The energy associated with ponded water, in [KJ], given by:</p>
<div class="math notranslate nohighlight">
\[E = V * ( \eta h u_l n_l + (1 - \eta) h u_i n_i )\]</div>
<p><cite>“evaluator type</cite>” = <cite>“surface ice energy</cite>”</p>
<div class="admonition-evaluator-surface-ice-energy-spec admonition" id="evaluator-surface-ice-energy-spec">
<p class="admonition-title">evaluator-surface-ice-energy-spec</p>
<p>DEPENDENCIES:</p>
<ul class="simple">
<li><p><cite>“ponded depth</cite>”  Height of water above the land surface [m]</p></li>
<li><p><cite>“unfrozen fraction</cite>”  The fraction of unfrozen water ranges from 0 to 1. [-]</p></li>
<li><p><cite>“molar density liquid</cite>” [mol m^-3]</p></li>
<li><p><cite>“internal energy liquid</cite>” [KJ mol^-1]</p></li>
<li><p><cite>“molar density ice</cite>” [mol m^-3]</p></li>
<li><p><cite>“internal energy ice</cite>” [KJ mol^-1]</p></li>
<li><p><cite>“cell volume</cite>” [m^2]</p></li>
</ul>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="secondary.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Secondary Variables</p>
      </div>
    </a>
    <a class="right-next"
       href="subsurface_flow.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Subsurface Flow Evaluators</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 202X, jointly shared by contributor institutions.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>